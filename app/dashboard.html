<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Dashboard | RF Finance Empresarial</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="manifest" href="../manifest.json">

<link rel="stylesheet" href="../theme/variables.css">
<link rel="stylesheet" href="../theme/global.css">
</head>
<body>

<!-- MENU -->
<div id="menu"></div>

<main class="container">
  <h1>Dashboard Financeiro</h1>

  <div class="card">
    <p>Receita Total</p>
    <h2>R$ <span id="receita">0,00</span></h2>
  </div>

  <div class="card">
    <p>Custo dos Produtos</p>
    <h2>R$ <span id="custos">0,00</span></h2>
  </div>

  <div class="card">
    <p>Impostos</p>
    <h2>R$ <span id="impostos">0,00</span></h2>
  </div>

  <div class="card">
    <p>Custo com Funcionários</p>
    <h2>R$ <span id="funcionarios">0,00</span></h2>
  </div>

  <div class="resultado" id="resultadoBox">
    <h2 id="resultadoValor">R$ 0,00</h2>
    <p id="status">Status</p>
  </div>
</main>

<!-- SCRIPTS CORE -->
<script src="../core/datamanager.js"></script>
<script src="../core/resultado.engine.js"></script>

<!-- MENU LOAD -->
<script>
fetch("menu.html")
  .then(r => r.text())
  .then(html => document.getElementById("menu").innerHTML = html);
</script>

<!-- DASHBOARD LOGIC -->
<script>
function render() {
  const r = ResultadoEngine.calcular();

  document.getElementById("receita").innerText = r.receita.toFixed(2);
  document.getElementById("custos").innerText = r.custoProdutos.toFixed(2);
  document.getElementById("impostos").innerText = r.impostos.toFixed(2);
  document.getElementById("funcionarios").innerText = r.custoFuncionarios.toFixed(2);

  document.getElementById("resultadoValor").innerText =
    "R$ " + r.resultado.toFixed(2);

  const box = document.getElementById("resultadoBox");
  const status = document.getElementById("status");

  if (r.status === "lucro") {
    box.className = "resultado lucro";
    status.innerText = "Lucro";
  } else if (r.status === "prejuizo") {
    box.className = "resultado prejuizo";
    status.innerText = "Prejuízo";
  } else {
    box.className = "resultado empate";
    status.innerText = "Empate";
  }
}

render();
</script>

<!-- SERVICE WORKER -->
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("../service-worker.js");
}
</script>

</body>
</html>