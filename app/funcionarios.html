<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Funcionários | RF Finance Empresarial</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="stylesheet" href="../theme/variables.css">
<link rel="stylesheet" href="../theme/global.css">
</head>
<body>

<main class="container">
  <h1>Funcionários</h1>
  <p>Informe os dados do funcionário. O sistema calculará o custo real automaticamente.</p>

  <label>Nome do Funcionário</label>
  <input id="nome" type="text" placeholder="Ex: João da Silva">

  <label>Salário Bruto Mensal (R$)</label>
  <input id="salario" type="number" step="0.01" placeholder="Ex: 1800">

  <label>Encargos (%)</label>
  <input id="encargos" type="number" step="0.01" placeholder="Ex: 70">
  <small>Se não souber, use 70% (padrão Brasil).</small>

  <label>Horas Trabalhadas no Mês</label>
  <input id="horas" type="number" placeholder="Ex: 220">

  <button onclick="salvar()">Adicionar Funcionário</button>

  <hr>

  <h2>Funcionários Cadastrados</h2>
  <ul id="lista"></ul>
</main>

<script src="../core/datamanager.js"></script>
<script src="../core/maoobra.engine.js"></script>

<script>
function salvar() {
  if (!nome.value || !salario.value || !horas.value) {
    alert("Preencha todos os campos obrigatórios");
    return;
  }

  DataManager.push("funcionarios", {
    nome: nome.value,
    salario: Number(salario.value),
    encargos: Number(encargos.value || 70),
    horasMensais: Number(horas.value)
  });

  limpar();
  render();
}

function limpar() {
  nome.value = "";
  salario.value = "";
  encargos.value = "";
  horas.value = "";
}

function render() {
  const lista = document.getElementById("lista");
  lista.innerHTML = "";

  const funcionarios = DataManager.get("funcionarios") || [];

  funcionarios.forEach((f, i) => {
    const custoHora = MaoDeObraEngine.custoHora(f).toFixed(2);

    const li = document.createElement("li");
    li.innerHTML = `
      <div>
        <strong>${f.nome}</strong><br>
        Salário: R$ ${f.salario.toFixed(2)}<br>
        Custo por hora: R$ ${custoHora}
      </div>
      <button onclick="remover(${i})">X</button>
    `;
    lista.appendChild(li);
  });
}

function remover(index) {
  const funcionarios = DataManager.get("funcionarios");
  funcionarios.splice(index, 1);
  DataManager.set("funcionarios", funcionarios);
  render();
}

render();
</script>

</body>
</html>